# 用于实时和高效功率信号处理的基于忆阻器的模拟储池计算系统 清华大学唐建石

![](https://raw.githubusercontent.com/1910853272/image/master/img/202502120930423.png)

本文提出了一个完全模拟的储池计算系统，使用动态忆阻器作为储池层，非易失性忆阻器作为读出层。该系统能够以比数字系统低三个数量级的功耗处理时空信号，并在时序心律失常检测和时空动态手势识别任务中达到较高准确率。

# RC系统分类

<img src="https://raw.githubusercontent.com/1910853272/image/master/img/202502120958526.png" alt="iShot_2025-02-12_09.56.53" style="zoom:50%;" />

**a.全数字RC系统。**模拟输入信号由ADC转换为数字信号，然后基于数字单元馈送到储层和读出层。

**b.混合RC系统。**模拟信号基于模拟单元直接输入到储层，并且模拟储层状态被转换成数字信号，然后基于数字单元将数字信号馈送到读出层。

**c.完全模拟RC系统。**模拟输入信号直接输入到基于模拟单元的储层和读出层，消除转换和缓冲带来的延迟和功耗。

# 器件特性与DM-RC硬件系统架构

![iShot_2025-02-12_11.09.10](https://raw.githubusercontent.com/1910853272/image/master/img/202502121109445.png)

**左图为24个动态忆阻器DM的垂直堆叠结构光学图像及其电流-电压滞回曲线。**所有24个DM显示出类似的I-V曲线，并具有强烈的整流特性，这为设计储池提供了所需的非线性

**中间图为集成PCB系统。**包括电源模块、储池模块（动态忆阻器DM阵列）、微控制单元（MCU）、读取模块（包含4个非易失性忆阻器阵列NVM芯片）。

**右图为不同电阻状态下NVM的I-V曲线和NVM垂直堆叠结构。**

![iShot_2025-02-12_11.09.22](https://raw.githubusercontent.com/1910853272/image/master/img/202502121130210.png)

**b. DM节点信号处理** 

1.输入信号通过输入放大器放大一个倍数Ai 

2.放大的信号及其反向信号连接到多路复用器（MUX），MUX由一个特殊的掩模序列控制，该序列的脉冲宽度为δ。

3.掩模后的信号添加输入电压偏置Bi后施加到DM上 

4.DM的输出电流信号首先通过跨阻放大器（TIA）转换为电压信号，然后通过输出放大器放大一个倍数Ao 

5.输出信号及其反向信号被送到读取模块

**c. DM-RC硬件系统的电路图** 

1.模拟输入信号直接输入到具有多个并行DM节点和不同掩模的储池模块中 

2.储池模块的输出信号以差分对的形式应用于NVM阵列的位线（BLs），以实现正负权重 

3.源线（SLs）的电流信号通过积分器收集，最终的输出信号通过采样积分器的输出信号得到。

# 超参数分析

<img src="https://raw.githubusercontent.com/1910853272/image/master/img/202502121210814.png" alt="iShot_2025-02-12_12.10.21" style="zoom: 50%;" />

**a. 实验方法：**DM节点行为通过电压扫描测得的输入输出（I-O）曲线来表征，DM-RC系统的性能通过波形分类任务中的归一化均方根误差（NRMSE）来衡量。储池模块中的四个超参数（即Ai、Bi、Ao和δ）外部可调节，在每组超参数下，记录了DM-RC系统的波形分类结果和相应的DM节点I-O曲线。

**b.实验结果：**在该超参数下，DM节点的归一化I-O曲线。

**c.仿真结果：**归一化I-O曲线提取三个关键特征：阈值（T）、斜率（S）和窗口（W）建立一个简化的DM节点模型，在一组仿真参数下的I-O曲线。

**d.系统性能随阈值和斜率的变化实验结果**

**e.系统性能随阈值和斜率的变化仿真结果**

**f.系统性能随窗口大小变化的实验结果**

**g.系统性能随窗口大小变化的仿真结果**

# 心律失常检测

![iShot_2025-02-12_13.59.27](https://raw.githubusercontent.com/1910853272/image/master/img/202502121359712.png)

**a. DM-RC系统的训练和测试过程：**仿真：训练数据通过DM储池，采样得到储池状态，训练得到目标电导权重，将电导权重映射到NVM。实验：测试数据通过DM储池处理后，接入NVM阵列以进行读取，输出结果通过参考值计算准确率。

**b.健康心跳和心律失常心跳**

**c.心律失常检测任务的网络结构：**心电信号输入到24个独立的DM节点，每个节点使用不同的掩模并并行处理，输出信号接入NVM阵列以进行读取。

**d.输入信号对应的归一化储池状态：**24个DM节点的输出被采样作为储池状态。掩模序列长度为5，每个DM节点在一个时间步可以产生5个水库状态，每个时间步的最终水库状态数量达到120。

**e.线性回归训练过程与噪声的关系：**所有时间步的水库状态组合生成状态矩阵X，将一个均匀分布的随机矩阵N_tr添加到X中计算W_out，$Wout=Ytarget(X+Ntr)T((X+Ntr)(X+Ntr)T)$。

**f.目标电导权重、映射电导权重及权重映射误差的分布**

**g.DM-RC系统的输入和输出信号：**输出信号能够有效地拟合目标信号，并在出现心律失常心跳时产生峰值。

**h.数字和完全模拟RC系统的分类准确率：**在保持高准确度的同时，模拟系统在效率和硬件成本有明显优势。

# 动态手势识别

![iShot_2025-02-12_14.47.39](https://raw.githubusercontent.com/1910853272/image/master/img/202502121447972.png)

**a.DM-RC系统的手势识别任务示意图：**手部执行特定手势时，来自加速度传感器的三维模拟信号直接输入到基于DM的储池模块中，生成的储池状态通过基于NVM阵列的读取模块以完全模拟的方式计算，最终输出识别结果

**b.手势信号：**记录了四类动态手势的传感器信号（G1：等边三角形，G2：大写字母N，G3：倒三角形，G4：大写字母Z），归一化振幅（−1到1）并切分为30个时间步的单个手势，生成数据集。

**c.网络结构：**24个DM节点均分为三个组，分别处理来自三个通道的输入信号，四个NVM阵列用于分类四种不同的手势类型

**d.储池状态：**24个DM节点输出的储池状态，掩模序列长度设置为8，每个时间步的储池状态数量为192。

**e.权重映射：**目标电导权重、映射电导权重以及与目标值的映射误差分布。

**f.实验结果：**四类动态手势的系统输出实验结果。使用参考值K_ref和输出值大于K_ref的次数N_ref，来获得四个独立输出的分类准确率。

**g.分类准确性与功耗比较：**在保持较高准确率的同时，显著降低了功耗。

# DM节点模型

$Vo(k)=f(S(Vi(k)−Vt(k)))$

- Vi(k) 是第 k 时间步的输入电压
- Vo(k)是第 k时间步的输出电压
- Vt(k) 是第 k时间步的阈值电压
- S 是输入输出曲线的斜率
- f 是非线性函数

阈值电压 Vt 会随着输入信号 Vi动态变化。假设动态过程是线性的且时间不变，Vt 是 Vi的线性滤波结果，线性滤波过程的微分方程为：

$Vt(k+1)=(1+α)Vt(k)−α(Vi(k)−2T)$

- $\alpha$是滤波器权重，决定了系统记忆的时间尺度
- T 是阈值电压的初始值，也对应于输入输出曲线提取的阈值

 $W=max⁡(Vt)−min⁡(Vt)$ 

上述是窗口宽度 W计算公式，Vt 的序列通过方程线性滤波过程的微分方程，使用 Vi的双扫序列计算得到。

仿真结果表明，只要器件的行为可以通过上述三个参数建模，其他器件也可以用来实现DM节点，用于RC系统，具体参数可能需要根据器件的特性进行优化。

# 权重映射过程

权重映射过程是一个闭环编程方案，用于将目标权重$W_{target}$映射到NVM阵列的设备导电性上。

PC程序包含四个核心功能：

- $f_{read}$：从PC发送命令到MCU，读取NVM的导电状态$W_{real}$。
- $f_{comp}$：计算实际权重$W_{real}$与目标权重$W_{target}$之间的差值 $\Delta W = W_{real} - W_{target}$，并通过最大误差权重$\Delta W_{max}$与 $\Delta W$进行比较，以决定下一步的编程操作。
  - 若 $\Delta W$小于$\Delta W_{max}$，则认为目标权重已成功映射，编程过程结束。
  - 若 $\Delta W$ 小于 -$\Delta W_{max}$，则执行$f_{set}$，进行SET操作，分别对1T1R单元的BL（比特线）和WL（字线）施加两个电压脉冲。
  - 若 $\Delta W$大于 $\Delta W_{max}$，则执行$f_{reset}$，进行RESET操作，分别对1T1R单元的SL（源线）和WL施加两个电压脉冲。

上述权重映射过程可以看出，$\Delta W_{max}$值越小，$W_{real}$越接近 $W_{target}$。但在实际操作中，$\Delta W_{max}$ 的最小值受到NVM器件固有噪声的限制，若低于此值，映射过程将难以收敛。

# 仿真

## 定义DM节点

<img src="https://raw.githubusercontent.com/1910853272/image/master/img/202502241025326.png" alt="iShot_2025-02-24_10.24.51"  />

## 仿真IV

<img src="https://raw.githubusercontent.com/1910853272/image/master/img/202502241053377.png" alt="iShot_2025-02-24_10.53.33"  />

<img src="https://raw.githubusercontent.com/1910853272/image/master/img/202502241100447.png" alt="iShot_2025-02-24_11.00.21"  />

## 仿真WFC

![iShot_2025-02-24_11.21.36](https://raw.githubusercontent.com/1910853272/image/master/img/202502241121274.png)

## 仿真动态手势识别DGR

加载DGRdataset.mat数据集，划分为训练集和测试集

![iShot_2025-02-25_21.44.21](https://raw.githubusercontent.com/1910853272/image/master/img/202502252144340.png)

## 心率失常检测ECG（心电图，electrocardiogram）

加载ECGpara.mat，训练过程与DGR一样。

# 上位PC程序

通过发送特定格式的命令和数据来配置、初始化和控制硬件